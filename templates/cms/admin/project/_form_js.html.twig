<script type="text/javascript" src="{{ asset('admin/js/ckeditor/ckeditor.js') }}"></script>
<script type="text/javascript" src="{{ asset('admin/js/plugins/forms/validation/validate.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('admin/js/pages/form_validation.js') }}"></script>
<script type="text/javascript" src="{{ asset('admin/js/plugins/forms/selects/select2.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('admin/js/plugins/forms/styling/switchery.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('admin/js/plugins/sortable/jquery-sortable.js') }}"></script>
<script type="text/javascript" src="{{ asset('admin/js/plugins/notifications/bootbox.min.js') }}"></script>

{% include '@PNSeo/Administration/Seo/seo.js.html.twig' with {'entity':project} %}
<script>
    var relatedProductUrl = '{{ path('related_product_select_ajax') }}';
    $(document).ready(function () {

        $('[name*="[relatedProducts]"]').select2({
            minimumInputLength: 2,
            language: {
                inputTooShort: function () {
                    return "Please enter product name";
                }
            },
            ajax: {
                url: relatedProductUrl,
                delay: 250,
                data: function (params) {
                    return {
                        q: params.term, // search term
                        page: params.page,
                    };
                }
            }
        });
        $('.sorted_table').sortable({
            containerSelector: 'table',
            itemPath: '> tbody',
            itemSelector: 'tr',
            placeholder: '<tr class="placeholder"/>',
            delay: 500,
        });

        var productPriceHolder = $('#addTable>tbody');

        if (productPriceHolder.find("td").length == 0) {
            addPrice();
        }

        function addPrice() {
            var collectionHolder = $('#addPrice');
            var prototype = collectionHolder.attr('data-prototype');
            form = prototype.replace(/\_\_name\_\_/g, productPriceHolder.children().length);
            productPriceHolder.append(form);
            $(".sorted_table").sortable('refresh');
        }

        $("#addPrice").on('click', function (e) {
            e.preventDefault();
            addPrice();
        });

        $("body").on("click", ".delete", function (e) {
            var $this = $(this);
            bootbox.confirm({
                title: 'Confirm dialog',
                message: 'Are you sure you want to delete?',
                buttons: {
                    confirm: {
                        label: 'OK',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'Cancel',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if (result === true) {
                        $this.parent().parent().remove();
                    }
                }
            });
        });
    });
</script>